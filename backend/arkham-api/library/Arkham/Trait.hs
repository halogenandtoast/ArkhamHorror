module Arkham.Trait (
  displayTrait,
  Trait (..),
  EnemyTrait (..),
  HasTraits (..),
) where

import Arkham.Prelude
import Data.Char (isLower, isUpper)

newtype EnemyTrait = EnemyTrait {unEnemyTrait :: Trait}

data Trait
  = Abomination
  | Agency
  | Ally
  | Altered
  | Ancient
  | AncientOne
  | Arkham
  | ArkhamAsylum
  | Armor
  | Artist
  | Assistant
  | Augury
  | Avatar
  | Basement
  | Bayou
  | Believer
  | Blessed
  | Blunder
  | Boat
  | Bold
  | Boon
  | Bridge
  | Broken
  | Byakhee
  | Bystander
  | Campsite
  | Carnevale
  | Castle
  | Cave
  | Central
  | Charm
  | Chosen
  | Circle
  | City
  | Civic
  | Clairvoyant
  | Clothing
  | CloverClub
  | Coastal
  | Composure
  | Condition
  | Connection
  | Conspirator
  | Construct
  | Cosmos
  | Coterie
  | Courage
  | Covenant
  | Creature
  | CrimeScene
  | Criminal
  | Cultist
  | Curse
  | Cursed
  | DarkYoung
  | DeepOne
  | Depths
  | Desperate
  | Detective
  | Developed
  | Dhole
  | Dilemma
  | Dinosaur
  | Double
  | Dreamer
  | Dreamlands
  | Drifter
  | Dunwich
  | Eidolon
  | ElderThing
  | Eldritch
  | Elite
  | Endtimes
  | Entrepreneur
  | Evidence
  | Exhibit
  | Expedition
  | Expert
  | Extradimensional
  | Extraterrestrial
  | Eztli
  | FalconPoint
  | Familiar
  | Fated
  | Favor
  | Firearm
  | Flaw
  | Flora
  | Footwear
  | Forbidden
  | Forgotten
  | Fortune
  | Future
  | Gambit
  | Geist
  | Ghast
  | Ghoul
  | Glacier
  | Grant
  | Graveyard
  | GroundFloor
  | Guest
  | Gug
  | Hall
  | Hardship
  | Hazard
  | Hex
  | Hideout
  | HistoricalSociety
  | Human
  | Humanoid
  | Hunter
  | Hybrid
  | Illicit
  | Improvised
  | Injury
  | Innate
  | Innocent
  | Innsmouth
  | Insect
  | Insight
  | Instrument
  | Island
  | Item
  | Job
  | Jungle
  | Kadath
  | Key
  | Kingsport
  | Lair
  | LanternClub
  | Lead
  | Leader
  | Leng
  | Lodge
  | Lunatic
  | Madness
  | Mainland
  | Manifold
  | Manor
  | Mask
  | Medic
  | Melee
  | MexicoCity
  | MiGo
  | Midtown
  | Mirage
  | Misfortune
  | Miskatonic
  | Mnar
  | Monster
  | Mountain
  | Mountains
  | Mystery
  | NewOrleans
  | Nightgaunt
  | Obstacle
  | Occult
  | Ocean
  | Omen
  | OothNargai
  | Oriab
  | Otherworld
  | Pact
  | Paradox
  | Paris
  | Passageway
  | Patron
  | Performer
  | Pnakotus
  | Poison
  | Police
  | Port
  | Possessed
  | Power
  | Practiced
  | PresentDay
  | Private
  | Prop
  | Rail
  | Ranged
  | Relic
  | Reporter
  | Research
  | Resolute
  | Ritual
  | RitualSite
  | Rival
  | River
  | Riverside
  | Road
  | Rot
  | Ruins
  | Salem
  | Sanctum
  | Satellite
  | Saturnite
  | Scheme
  | Scholar
  | Science
  | Scion
  | SecondFloor
  | SentinelHill
  | Serpent
  | Service
  | Servitor
  | Set
  | Shantak
  | Shattered
  | Ship
  | Shoggoth
  | SilverTwilight
  | Skai
  | Socialite
  | Song
  | Sorcerer
  | Spectral
  | Spell
  | Spider
  | Spirit
  | StMarys
  | Staff
  | Steps
  | Summon
  | Supply
  | Surface
  | Suspect
  | Syndicate
  | Synergy
  | Tactic
  | Talent
  | Tarot
  | Task
  | Temple
  | Tenochtitlan
  | Tentacle
  | Terror
  | ThirdFloor
  | Tindalos
  | Tome
  | Tool
  | Train
  | Trap
  | Trick
  | Unbroken
  | Uncharted
  | Unhallowed
  | Upgrade
  | Vale
  | Vehicle
  | Venice
  | Veteran
  | Void
  | Warden
  | Wastes
  | Wayfarer
  | Weapon
  | Wilderness
  | Witch
  | WitchHouse
  | Woods
  | Yhanthlei
  | Yithian
  | Yoth
  | Zoog
  deriving stock (Show, Eq, Generic, Ord, Enum, Bounded, Read, Data)
  deriving anyclass (ToJSON, FromJSON, Hashable)

class HasTraits a where
  toTraits :: a -> Set Trait

displayTrait :: Trait -> Text
displayTrait t = pack $ splitCamelCase $ show t

splitCamelCase :: String -> String
splitCamelCase "" = ""
splitCamelCase [x] = [x]
splitCamelCase (x : y : rest) =
  if isLower x && isUpper y
    then [x, ' ', y] <> splitCamelCase rest
    else [x] <> splitCamelCase (y : rest)
